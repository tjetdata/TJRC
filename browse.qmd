---
title: "Browse Records"
editor: source
format: 
  html: 
    df-print: paged
---

Please select a mechanism to browse the data and use keywords and/or filters to narrow your search. Click on table rows to expand records.

``` {r}
#| include: false
library(tidyverse)
library(reactable)
library(htmltools)
library(tippy)
library(fontawesome)

ctry <- read_csv(here::here("_data", "country_list_tjet.csv")) %>% 
  select(countryid, country) 

with_tooltip <- function(value, tooltip, ...) {
  div(style = "text-decoration: underline; text-decoration-style: dotted; cursor: help",
      tippy(value, tooltip, ...))
}
```


::: {.panel-tabset group="mechanism"}

## Amnesties

:::: {.panel-tabset}

## Amnesties

``` {r}
#| echo: false
#| warning: false

df <- read_csv("_data/amnesties.csv", skip = 1) %>%
  left_join(ctry, by = c(countryID = "countryid"), keep = FALSE) %>% 
  select(amnestyID, country, amnestyYear, narrative) 

htmltools::browsable(
  tagList(
    df %>% 
      reactable(searchable = TRUE, 
                filterable = TRUE,
                sortable = TRUE,
                showSortable = TRUE,
                resizable = TRUE,
                borderless = FALSE,
                striped = FALSE,
                highlight = TRUE,
                static = TRUE,
                compact = FALSE, 
                bordered = FALSE,
                height = 500,
                pagination = FALSE,
                # showPageSizeOptions = TRUE, 
                # pageSizeOptions = c(10, 25, 50, 100, 500, 1000),
                # defaultPageSize = 25,
                # paginationType = "jump",
                defaultColDef = colDef(minWidth = 100),
                defaultSorted = list(amnestyID = "asc"),
                columns = list(
                  amnestyID = colDef(name = "ID", 
                                     header = with_tooltip("ID", "Amnesty ID"),
                                     filterable = FALSE,
                                     width = 60),
                  narrative = colDef(show = FALSE, searchable = TRUE),
                  country = colDef(name = "Country", 
                    filterInput = function(values, name) {
                      tags$select(
                        # Set to undefined to clear the filter
                        onchange = sprintf("Reactable.setFilter('amnesties-temp', '%s', event.target.value || undefined)", name),
                        # "All" has an empty value to clear the filter, and is the default option
                        tags$option(value = "", "All countries"),
                        lapply(sort(unique(values)), tags$option),
                        "aria-label" = sprintf("Filter %s", name),
                        style = "height: 100%; width: 99%"
                      )
                    }
                  ),
                  amnestyYear = colDef(name = "Year", 
                                       width = 120,
                    filterInput = function(values, name) {
                      tags$select(
                        onchange = sprintf("Reactable.setFilter('amnesties-temp', '%s', event.target.value || undefined)", name),
                        tags$option(value = "", "All years"),
                        lapply(sort(unique(values)), tags$option),
                        "aria-label" = sprintf("Filter %s", name),
                        style = "height: 100%; width: 99%"
                      )
                    }
                  )
                ),
                details = function(index) paste("Narrative:", df[index, "narrative"]),
                defaultExpanded = FALSE,
                onClick = "expand",
                language = reactableLang(
                  searchPlaceholder = "Search keyword...",
                  noData = "No entries found"
                ),
                theme = reactableTheme(
                  searchInputStyle = list(width = "100%")
                ),
                elementId = "amnesties-temp"
      ),
    tags$button(
      "Expand or collapse additional information",
      onclick = "Reactable.toggleAllRowsExpanded('amnesties-temp')"
    )
  )
)
```

## Challenges 

``` {r}
#| echo: false
#| warning: false
read_csv("_data/challenges.csv", skip = 1) %>% 
  left_join(df %>% select(amnestyID, country), by = "amnestyID", keep = FALSE) %>% 
  reactable(searchable = TRUE, 
            filterable = TRUE,
            sortable = TRUE,
            showSortable = TRUE,
            resizable = TRUE,
            static = FALSE,
            compact = TRUE, 
            height = 600,
            showPageSizeOptions = TRUE, 
            pageSizeOptions = c(10, 25, 50, 100, 500, 1000),
            defaultPageSize = 25,
            defaultColDef = colDef(minWidth = 100)
  )
```

::::

## Customary Justice

``` {r}
#| echo: false
#| warning: false

read_csv("_data/customaryjustice.csv", skip = 1) %>% 
  left_join(ctry, by = c(countryID = "countryid"), keep = FALSE) %>% 
  rename(ID = customaryjusticeID, 
         Country = countryID) %>% 
  reactable(searchable = TRUE, 
            filterable = TRUE,
            sortable = TRUE,
            showSortable = TRUE,
            resizable = TRUE,
            static = FALSE,
            compact = TRUE, 
            height = 600,
            showPageSizeOptions = TRUE, 
            pageSizeOptions = c(10, 25, 50, 100, 500, 1000),
            defaultPageSize = 25,
            defaultColDef = colDef(minWidth = 100)
  )
```

## Reparation

``` {r}
#| echo: false
#| warning: false
read_csv("_data/reparations.csv", skip = 1) %>% 
  left_join(ctry, by = c(countryID = "countryid"), keep = FALSE) %>% 
  rename(ID = reparationID, 
         Country = countryID) %>% 
  reactable(searchable = TRUE, 
            filterable = TRUE,
            sortable = TRUE,
            showSortable = TRUE,
            resizable = TRUE,
            static = FALSE,
            compact = TRUE, 
            height = 600,
            showPageSizeOptions = TRUE, 
            pageSizeOptions = c(10, 25, 50, 100, 500, 1000),
            defaultPageSize = 25,
            defaultColDef = colDef(minWidth = 100)
  )
```

## Trials

:::: {.panel-tabset group="trials"}

## International 

``` {r}
#| echo: false
#| warning: false

df <- read_csv("_data/trials.csv", skip = 1) %>% 
  left_join(ctry, by = c(countryID = "countryid"), keep = FALSE)

df %>% 
  filter(trialType == 3) %>% 
  rename(ID = trialID) %>% 
  reactable(searchable = TRUE, 
            filterable = TRUE,
            sortable = TRUE,
            showSortable = TRUE,
            resizable = TRUE,
            static = FALSE,
            compact = TRUE, 
            height = 600,
            showPageSizeOptions = TRUE, 
            pageSizeOptions = c(10, 25, 50, 100, 500, 1000),
            defaultPageSize = 25,
            defaultColDef = colDef(minWidth = 100)
  )
```

## Foreign 

``` {r}
#| echo: false
#| warning: false
df %>% 
  filter(trialType == 2) %>%
  rename(ID = trialID) %>% 
  reactable(searchable = TRUE, 
            filterable = TRUE,
            sortable = TRUE,
            showSortable = TRUE,
            resizable = TRUE,
            static = FALSE,
            compact = TRUE, 
            height = 600,
            showPageSizeOptions = TRUE, 
            pageSizeOptions = c(10, 25, 50, 100, 500, 1000),
            defaultPageSize = 25,
            defaultColDef = colDef(minWidth = 100)
  )
```

## Domestic 

``` {r}
#| echo: false
#| warning: false
df %>% 
  filter(trialType == 1) %>% 
  rename(ID = trialID) %>% 
  reactable(searchable = TRUE, 
            filterable = TRUE,
            sortable = TRUE,
            showSortable = TRUE,
            resizable = TRUE,
            static = FALSE,
            compact = TRUE, 
            height = 600,
            showPageSizeOptions = TRUE, 
            pageSizeOptions = c(10, 25, 50, 100, 500, 1000),
            defaultPageSize = 25,
            defaultColDef = colDef(minWidth = 100)
  )
```

## Civil 

``` {r}
#| echo: false
#| warning: false
read_csv("_data/civiltrials.csv", skip = 1) %>% 
  left_join(ctry, by = c(countryViolationID = "countryid"), keep = FALSE) %>% 
  rename(ID = civiltrialID) %>% 
  reactable(searchable = TRUE, 
            filterable = TRUE,
            sortable = TRUE,
            showSortable = TRUE,
            resizable = TRUE,
            static = FALSE,
            compact = TRUE, 
            height = 600,
            showPageSizeOptions = TRUE, 
            pageSizeOptions = c(10, 25, 50, 100, 500, 1000),
            defaultPageSize = 25,
            defaultColDef = colDef(minWidth = 100)
  )
```

## The Accused 

``` {r}
#| echo: false
#| warning: false

read_csv("_data/accusations.csv", skip = 1) %>% 
  left_join(df %>% select(trialID, country), by = "trialID", keep = FALSE) %>%
  rename(ID = accusationID) %>% 
  reactable(searchable = TRUE, 
            filterable = TRUE,
            sortable = TRUE,
            showSortable = TRUE,
            resizable = TRUE,
            static = FALSE,
            compact = TRUE, 
            height = 600,
            showPageSizeOptions = TRUE, 
            pageSizeOptions = c(10, 25, 50, 100, 500, 1000),
            defaultPageSize = 25,
            defaultColDef = colDef(minWidth = 100)
  )
```

::::

## Truth Commissions

``` {r}
#| echo: false
#| warning: false
read_csv("_data/tcs.csv", skip = 1) %>% 
  left_join(ctry, by = c(countryID = "countryid"), keep = FALSE) %>% 
  rename(ID = truthcommissionID, 
         Country = countryID) %>% 
  reactable(searchable = TRUE, 
            filterable = TRUE,
            sortable = TRUE,
            showSortable = TRUE,
            resizable = TRUE,
            static = FALSE,
            compact = TRUE, 
            height = 600,
            showPageSizeOptions = TRUE, 
            pageSizeOptions = c(10, 25, 50, 100, 500, 1000),
            defaultPageSize = 25,
            defaultColDef = colDef(minWidth = 100)
  )
```

## Vetting

``` {r}
#| echo: false
#| warning: false
read_csv("_data/vettings.csv", skip = 1) %>% 
  left_join(ctry, by = c(countryID = "countryid"), keep = FALSE) %>% 
  rename(ID = vettingID, 
         Country = countryID) %>% 
  reactable(searchable = TRUE, 
            filterable = TRUE,
            sortable = TRUE,
            showSortable = TRUE,
            resizable = TRUE,
            static = FALSE,
            compact = TRUE, 
            height = 600,
            showPageSizeOptions = TRUE, 
            pageSizeOptions = c(10, 25, 50, 100, 500, 1000),
            defaultPageSize = 25,
            defaultColDef = colDef(minWidth = 100)
  )
```

:::

<!-- Click here to hide additional filtering options. -->

<!-- Hover over each filtering option to see more information. -->

<!-- Context: -->

<!-- Filter by Keywords: -->

<!-- War Context: -->

<!-- Crimes Covered: -->

<!-- Fits definition of TJ: -->

<!-- Year: -->

{{< include _footer.qmd >}}
